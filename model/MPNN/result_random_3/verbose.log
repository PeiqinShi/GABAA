Command line
python D:\anaconda\envs\chemprop\Scripts\chemprop_train --data_path ../../data/stan_data_mpnn.csv --dataset_type classification --metric auc --extra_metrics accuracy pre rec --seed 400 --save_dir result_random_3
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': '../../data/stan_data_mpnn.csv',
 'data_weights_path': None,
 'dataset_type': 'classification',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['accuracy', 'pre', 'rec'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'loss_function': 'binary_cross_entropy',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'auc',
 'metrics': ['auc', 'accuracy', 'pre', 'rec'],
 'minimize_score': False,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'result_random_3',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 400,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['target'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 400
Class sizes
target 0: 51.32%, 1: 48.68%
Total size = 1,251 | train size = 1,000 | val size = 125 | test size = 126
Building model 0
MoleculeModel(
  (sigmoid): Sigmoid()
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Epoch 0
Loss = 7.0011e-01, PNorm = 34.0107, GNorm = 0.1670, lr_0 = 3.4750e-04
Loss = 6.8923e-01, PNorm = 34.0187, GNorm = 0.5599, lr_0 = 5.7250e-04
Validation auc = 0.646543
Validation accuracy = 0.536000
Validation pre = 0.727273
Validation rec = 0.235294
Epoch 1
Loss = 6.8192e-01, PNorm = 34.0393, GNorm = 0.7264, lr_0 = 7.9750e-04
Loss = 7.0711e-01, PNorm = 34.0713, GNorm = 0.4030, lr_0 = 9.9590e-04
Validation auc = 0.698400
Validation accuracy = 0.664000
Validation pre = 0.842105
Validation rec = 0.470588
Epoch 2
Loss = 6.8351e-01, PNorm = 34.1147, GNorm = 0.6322, lr_0 = 9.5578e-04
Loss = 6.8896e-01, PNorm = 34.1658, GNorm = 0.1265, lr_0 = 9.1728e-04
Validation auc = 0.648091
Validation accuracy = 0.600000
Validation pre = 0.602273
Validation rec = 0.779412
Epoch 3
Loss = 6.7593e-01, PNorm = 34.2288, GNorm = 0.1441, lr_0 = 8.8032e-04
Loss = 6.7399e-01, PNorm = 34.2980, GNorm = 0.5566, lr_0 = 8.4486e-04
Validation auc = 0.682405
Validation accuracy = 0.624000
Validation pre = 0.818182
Validation rec = 0.397059
Epoch 4
Loss = 6.4539e-01, PNorm = 34.3939, GNorm = 0.2814, lr_0 = 8.1083e-04
Loss = 6.9160e-01, PNorm = 34.4853, GNorm = 1.5279, lr_0 = 7.7816e-04
Validation auc = 0.660217
Validation accuracy = 0.512000
Validation pre = 0.888889
Validation rec = 0.117647
Epoch 5
Loss = 6.6082e-01, PNorm = 34.5569, GNorm = 0.3130, lr_0 = 7.4682e-04
Loss = 6.4436e-01, PNorm = 34.6365, GNorm = 0.1671, lr_0 = 7.1673e-04
Validation auc = 0.683437
Validation accuracy = 0.648000
Validation pre = 0.772727
Validation rec = 0.500000
Epoch 6
Loss = 6.1712e-01, PNorm = 34.7350, GNorm = 0.3726, lr_0 = 6.8786e-04
Loss = 6.2185e-01, PNorm = 34.8365, GNorm = 0.5305, lr_0 = 6.6015e-04
Validation auc = 0.701238
Validation accuracy = 0.656000
Validation pre = 0.765957
Validation rec = 0.529412
Epoch 7
Loss = 5.9509e-01, PNorm = 34.9271, GNorm = 1.3109, lr_0 = 6.3356e-04
Loss = 6.0661e-01, PNorm = 35.0104, GNorm = 0.6789, lr_0 = 6.0803e-04
Validation auc = 0.715944
Validation accuracy = 0.616000
Validation pre = 0.916667
Validation rec = 0.323529
Epoch 8
Loss = 6.0233e-01, PNorm = 35.0846, GNorm = 0.7652, lr_0 = 5.8354e-04
Loss = 5.5897e-01, PNorm = 35.1655, GNorm = 0.6731, lr_0 = 5.6003e-04
Validation auc = 0.729102
Validation accuracy = 0.672000
Validation pre = 0.721311
Validation rec = 0.647059
Epoch 9
Loss = 5.4646e-01, PNorm = 35.2495, GNorm = 0.7802, lr_0 = 5.3747e-04
Loss = 5.7345e-01, PNorm = 35.3217, GNorm = 0.8367, lr_0 = 5.1582e-04
Validation auc = 0.744582
Validation accuracy = 0.712000
Validation pre = 0.807692
Validation rec = 0.617647
Epoch 10
Loss = 5.2881e-01, PNorm = 35.3832, GNorm = 0.5837, lr_0 = 4.9504e-04
Loss = 5.2299e-01, PNorm = 35.4534, GNorm = 0.9997, lr_0 = 4.7510e-04
Validation auc = 0.760836
Validation accuracy = 0.728000
Validation pre = 0.814815
Validation rec = 0.647059
Epoch 11
Loss = 5.1729e-01, PNorm = 35.5121, GNorm = 0.7127, lr_0 = 4.5596e-04
Loss = 4.8495e-01, PNorm = 35.5759, GNorm = 1.1974, lr_0 = 4.3759e-04
Validation auc = 0.783282
Validation accuracy = 0.736000
Validation pre = 0.872340
Validation rec = 0.602941
Epoch 12
Loss = 4.8190e-01, PNorm = 35.6325, GNorm = 0.8140, lr_0 = 4.1997e-04
Loss = 4.9569e-01, PNorm = 35.6862, GNorm = 0.7585, lr_0 = 4.0305e-04
Validation auc = 0.795924
Validation accuracy = 0.752000
Validation pre = 0.862745
Validation rec = 0.647059
Epoch 13
Loss = 4.9418e-01, PNorm = 35.7376, GNorm = 3.5761, lr_0 = 3.8681e-04
Loss = 5.1446e-01, PNorm = 35.7803, GNorm = 1.4891, lr_0 = 3.7123e-04
Validation auc = 0.795666
Validation accuracy = 0.712000
Validation pre = 0.700000
Validation rec = 0.823529
Epoch 14
Loss = 4.7027e-01, PNorm = 35.8304, GNorm = 1.3348, lr_0 = 3.5628e-04
Loss = 4.8640e-01, PNorm = 35.8771, GNorm = 0.8660, lr_0 = 3.4192e-04
Validation auc = 0.798246
Validation accuracy = 0.736000
Validation pre = 0.807018
Validation rec = 0.676471
Epoch 15
Loss = 4.6116e-01, PNorm = 35.9234, GNorm = 0.6667, lr_0 = 3.2815e-04
Loss = 4.4650e-01, PNorm = 35.9648, GNorm = 1.0583, lr_0 = 3.1493e-04
Validation auc = 0.800310
Validation accuracy = 0.760000
Validation pre = 0.880000
Validation rec = 0.647059
Epoch 16
Loss = 4.5511e-01, PNorm = 36.0068, GNorm = 2.5591, lr_0 = 3.0224e-04
Loss = 4.4493e-01, PNorm = 36.0475, GNorm = 1.0560, lr_0 = 2.9007e-04
Validation auc = 0.801600
Validation accuracy = 0.744000
Validation pre = 0.757143
Validation rec = 0.779412
Epoch 17
Loss = 4.7955e-01, PNorm = 36.0816, GNorm = 1.2162, lr_0 = 2.7838e-04
Loss = 4.3419e-01, PNorm = 36.1185, GNorm = 0.9706, lr_0 = 2.6717e-04
Validation auc = 0.812951
Validation accuracy = 0.784000
Validation pre = 0.859649
Validation rec = 0.720588
Epoch 18
Loss = 4.4079e-01, PNorm = 36.1566, GNorm = 1.5038, lr_0 = 2.5641e-04
Loss = 4.1610e-01, PNorm = 36.1909, GNorm = 0.9289, lr_0 = 2.4608e-04
Validation auc = 0.825335
Validation accuracy = 0.776000
Validation pre = 0.822581
Validation rec = 0.750000
Epoch 19
Loss = 4.0977e-01, PNorm = 36.2268, GNorm = 0.6711, lr_0 = 2.3616e-04
Loss = 4.0795e-01, PNorm = 36.2548, GNorm = 2.4725, lr_0 = 2.2665e-04
Validation auc = 0.825335
Validation accuracy = 0.760000
Validation pre = 0.779412
Validation rec = 0.779412
Epoch 20
Loss = 4.3054e-01, PNorm = 36.2850, GNorm = 1.3631, lr_0 = 2.1752e-04
Loss = 3.8381e-01, PNorm = 36.3143, GNorm = 1.4086, lr_0 = 2.0876e-04
Validation auc = 0.828173
Validation accuracy = 0.760000
Validation pre = 0.787879
Validation rec = 0.764706
Epoch 21
Loss = 3.7455e-01, PNorm = 36.3470, GNorm = 0.7886, lr_0 = 2.0035e-04
Loss = 4.0404e-01, PNorm = 36.3750, GNorm = 2.4294, lr_0 = 1.9228e-04
Validation auc = 0.841331
Validation accuracy = 0.784000
Validation pre = 0.859649
Validation rec = 0.720588
Epoch 22
Loss = 4.2191e-01, PNorm = 36.4013, GNorm = 1.1607, lr_0 = 1.8453e-04
Loss = 3.5840e-01, PNorm = 36.4280, GNorm = 0.9354, lr_0 = 1.7710e-04
Validation auc = 0.842879
Validation accuracy = 0.792000
Validation pre = 0.818182
Validation rec = 0.794118
Epoch 23
Loss = 3.7699e-01, PNorm = 36.4531, GNorm = 1.6107, lr_0 = 1.6996e-04
Loss = 4.0737e-01, PNorm = 36.4757, GNorm = 2.5054, lr_0 = 1.6312e-04
Validation auc = 0.840299
Validation accuracy = 0.792000
Validation pre = 0.862069
Validation rec = 0.735294
Epoch 24
Loss = 3.8317e-01, PNorm = 36.4997, GNorm = 1.1919, lr_0 = 1.5655e-04
Loss = 3.8349e-01, PNorm = 36.5224, GNorm = 0.7169, lr_0 = 1.5024e-04
Validation auc = 0.840041
Validation accuracy = 0.784000
Validation pre = 0.847458
Validation rec = 0.735294
Epoch 25
Loss = 3.3349e-01, PNorm = 36.5459, GNorm = 1.5861, lr_0 = 1.4419e-04
Loss = 3.8964e-01, PNorm = 36.5673, GNorm = 1.3001, lr_0 = 1.3838e-04
Validation auc = 0.848813
Validation accuracy = 0.752000
Validation pre = 0.740260
Validation rec = 0.838235
Epoch 26
Loss = 3.5153e-01, PNorm = 36.5853, GNorm = 1.6071, lr_0 = 1.3280e-04
Loss = 3.6896e-01, PNorm = 36.6059, GNorm = 2.0875, lr_0 = 1.2746e-04
Validation auc = 0.855263
Validation accuracy = 0.800000
Validation pre = 0.811594
Validation rec = 0.823529
Epoch 27
Loss = 3.5027e-01, PNorm = 36.6243, GNorm = 1.1110, lr_0 = 1.2232e-04
Loss = 3.6027e-01, PNorm = 36.6419, GNorm = 1.1918, lr_0 = 1.1739e-04
Validation auc = 0.851135
Validation accuracy = 0.800000
Validation pre = 0.841270
Validation rec = 0.779412
Epoch 28
Loss = 3.4189e-01, PNorm = 36.6581, GNorm = 0.7218, lr_0 = 1.1266e-04
Loss = 3.5130e-01, PNorm = 36.6745, GNorm = 1.1486, lr_0 = 1.0813e-04
Validation auc = 0.856295
Validation accuracy = 0.776000
Validation pre = 0.857143
Validation rec = 0.705882
Epoch 29
Loss = 3.4782e-01, PNorm = 36.6917, GNorm = 1.1213, lr_0 = 1.0377e-04
Loss = 3.4413e-01, PNorm = 36.7056, GNorm = 0.8586, lr_0 = 1.0000e-04
Validation auc = 0.852425
Validation accuracy = 0.784000
Validation pre = 0.859649
Validation rec = 0.720588
Model 0 best validation auc = 0.856295 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test auc = 0.824212
Model 0 test accuracy = 0.801587
Model 0 test pre = 0.928571
Model 0 test rec = 0.639344
Ensemble test auc = 0.824212
Ensemble test accuracy = 0.801587
Ensemble test pre = 0.928571
Ensemble test rec = 0.639344
1-fold cross validation
	Seed 400 ==> test auc = 0.824212
	Seed 400 ==> test accuracy = 0.801587
	Seed 400 ==> test pre = 0.928571
	Seed 400 ==> test rec = 0.639344
Overall test auc = 0.824212 +/- 0.000000
Overall test accuracy = 0.801587 +/- 0.000000
Overall test pre = 0.928571 +/- 0.000000
Overall test rec = 0.639344 +/- 0.000000
Elapsed time = 0:05:31
